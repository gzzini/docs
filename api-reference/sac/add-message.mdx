---
title: "Adicionar Mensagem"
api: "POST https://sac-waffle-v2.theo-110.workers.dev/support/{id}/mensagens"
description: "Adiciona uma nova mensagem a um ticket"
---

## Descrição

Adiciona uma nova mensagem ao histórico de conversação de um ticket. Suporta operações em lote e envio de emails automáticos. Requer autenticação.

## Headers

<ParamField header="Authorization" type="string" required>
  Bearer token JWT para autenticação
</ParamField>

<ParamField header="Content-Type" type="string" required>
  `application/json`
</ParamField>

## Path Parameters

<ParamField path="id" type="number">
  ID do ticket (ignorado se `support_ids` for fornecido)
</ParamField>

## Body Parameters

<ParamField body="conteudo" type="string" required>
  Conteúdo da mensagem
</ParamField>

<ParamField body="remetente" type="string" default="suporte">
  Identificador do remetente
  
  Valores comuns:
  - `suporte` - Mensagem da equipe de suporte
  - `usuario` - Mensagem do usuário
  - Email do agente de suporte
</ParamField>

<ParamField body="enviarEmail" type="boolean" default="false">
  Se deve enviar a mensagem por email para o usuário
  
  Funciona apenas se o ticket tem email e `wantReply = true`
</ParamField>

<ParamField body="support_ids" type="array">
  Array de IDs de tickets para adicionar a mesma mensagem em lote
</ParamField>

## Response

<ResponseField name="success" type="boolean" required>
  Indica se a operação foi bem-sucedida
</ResponseField>

<ResponseField name="message" type="string" required>
  Mensagem descritiva do resultado
</ResponseField>

<ResponseField name="data" type="object">
  <Expandable title="Dados da mensagem">
    <ResponseField name="id" type="number">
      ID da mensagem criada
    </ResponseField>
    
    <ResponseField name="supportId" type="number">
      ID do ticket
    </ResponseField>
    
    <ResponseField name="conteudo" type="string">
      Conteúdo da mensagem
    </ResponseField>
    
    <ResponseField name="remetente" type="string">
      Identificador do remetente
    </ResponseField>
    
    <ResponseField name="createdAt" type="string">
      Data de criação
    </ResponseField>
    
    <ResponseField name="emailSent" type="boolean">
      Se o email foi enviado
    </ResponseField>
  </Expandable>
</ResponseField>

<RequestExample>

```bash Mensagem Simples
curl -X POST "https://sac-waffle-v2.theo-110.workers.dev/support/12345/mensagens" \
  -H "Authorization: Bearer seu_token_jwt" \
  -H "Content-Type: application/json" \
  -d '{
    "conteudo": "Obrigado pelo contato. Estamos analisando seu caso.",
    "remetente": "suporte"
  }'
```

```bash Com Envio de Email
curl -X POST "https://sac-waffle-v2.theo-110.workers.dev/support/12345/mensagens" \
  -H "Authorization: Bearer seu_token_jwt" \
  -H "Content-Type: application/json" \
  -d '{
    "conteudo": "Seu problema foi resolvido. Por favor, verifique e confirme.",
    "remetente": "joao@suporte.com",
    "enviarEmail": true
  }'
```

```bash Mensagem em Lote
curl -X POST "https://sac-waffle-v2.theo-110.workers.dev/support/0/mensagens" \
  -H "Authorization: Bearer seu_token_jwt" \
  -H "Content-Type: application/json" \
  -d '{
    "conteudo": "Informamos que houve uma atualização no sistema.",
    "remetente": "suporte",
    "support_ids": [12345, 12346, 12347],
    "enviarEmail": true
  }'
```

</RequestExample>

<ResponseExample>

```json Success
{
  "success": true,
  "message": "Mensagem adicionada com sucesso",
  "data": {
    "id": 567,
    "supportId": 12345,
    "conteudo": "Obrigado pelo contato. Estamos analisando seu caso.",
    "remetente": "suporte",
    "createdAt": "2024-01-14T15:30:00Z",
    "emailSent": false
  }
}
```

```json Success - Email Enviado
{
  "success": true,
  "message": "Mensagem adicionada e email enviado com sucesso",
  "data": {
    "id": 568,
    "supportId": 12345,
    "conteudo": "Seu problema foi resolvido. Por favor, verifique e confirme.",
    "remetente": "joao@suporte.com",
    "createdAt": "2024-01-14T16:00:00Z",
    "emailSent": true
  }
}
```

```json Error
{
  "success": false,
  "message": "Ticket não encontrado"
}
```

</ResponseExample>