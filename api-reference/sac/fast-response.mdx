---
title: "Fast Response (IA)"
api: "POST https://sac-waffle-v2.theo-110.workers.dev/support/fast-response"
description: "Gera respostas autom√°ticas inteligentes usando OpenAI para tickets de suporte"
---

## Vis√£o Geral

O sistema Fast Response utiliza IA (OpenAI) para gerar respostas autom√°ticas e inteligentes para tickets de suporte. Ele analisa o contexto do ticket, busca tickets similares anteriores e gera uma resposta personalizada com alta precis√£o.

## Endpoints Dispon√≠veis

### 1. Gerar Resposta R√°pida (Preview)

`POST /support/fast-response`

**P√∫blico** - Gera uma resposta de IA sem criar ticket. √ötil para preview em formul√°rios.

#### Body Parameters

<ParamField body="id" type="number">
  ID do ticket existente
  
  **Nota:** Se fornecido, busca automaticamente issue e description do banco
</ParamField>

<ParamField body="issue" type="string" conditionally-required>
  Assunto ou problema principal
  
  **Obrigat√≥rio** se `id` n√£o for fornecido
</ParamField>

<ParamField body="description" type="string" conditionally-required>
  Descri√ß√£o detalhada do problema
  
  **Obrigat√≥rio** se `id` n√£o for fornecido
</ParamField>

<ParamField body="main" type="string">
  Categoria principal (T√©cnico, Financeiro, Editorial, etc.)
</ParamField>

<ParamField body="newsletter" type="string">
  Newsletter relacionada
</ParamField>

### 2. Fast Response para Ticket Espec√≠fico

`POST /support/{id}/fast-response`

**Autenticado** - Gera resposta de IA para um ticket existente.

#### Path Parameters

<ParamField path="id" type="number" required>
  ID do ticket
</ParamField>

#### Body Parameters

<ParamField body="salvar" type="boolean" default="false">
  Se deve salvar a resposta como mensagem no ticket
</ParamField>

<ParamField body="autor" type="string" default="IA Assistant">
  Identifica√ß√£o do autor da mensagem
</ParamField>

<ParamField body="enviar_email" type="boolean" default="false">
  Se deve enviar a resposta por email ao usu√°rio
  
  **Nota:** Funciona apenas se o ticket tem email e `salvar=true`
</ParamField>

### 3. Fast Response em Lote

`POST /support/fast-response/lote`

**Autenticado** - Processa m√∫ltiplos tickets com IA simultaneamente.

#### Body Parameters

<ParamField body="support_ids" type="array" required>
  Array de IDs de tickets para processar
  
  **Limites:**
  - M√≠nimo: 1 ticket
  - M√°ximo: 50 tickets por requisi√ß√£o
</ParamField>

<ParamField body="salvar" type="boolean" default="false">
  Se deve salvar as respostas nos tickets
</ParamField>

<ParamField body="autor" type="string" default="IA Assistant">
  Identifica√ß√£o do autor para todas as mensagens
</ParamField>

<ParamField body="enviar_email" type="boolean" default="false">
  Se deve enviar emails para tickets com email cadastrado
</ParamField>

## Response Structure

<ResponseField name="success" type="boolean" required>
  Status da opera√ß√£o
</ResponseField>

<ResponseField name="data" type="object">
  <Expandable title="Dados da resposta gerada">
    <ResponseField name="response" type="string">
      Resposta gerada pela IA
    </ResponseField>
    
    <ResponseField name="confidence" type="number">
      N√≠vel de confian√ßa (0.0 a 1.0)
      
      **Interpreta√ß√£o:**
      - `> 0.8` - Alta confian√ßa
      - `0.5 - 0.8` - Confian√ßa m√©dia
      - `< 0.5` - Baixa confian√ßa
    </ResponseField>
    
    <ResponseField name="basedOnSimilar" type="boolean">
      Se a resposta foi baseada em tickets similares
    </ResponseField>
    
    <ResponseField name="similarTicketsUsed" type="number">
      Quantidade de tickets similares utilizados como contexto
    </ResponseField>
    
    <ResponseField name="salvo" type="boolean">
      Se a resposta foi salva no ticket (quando aplic√°vel)
    </ResponseField>
    
    <ResponseField name="email_enviado" type="boolean">
      Se o email foi enviado (quando aplic√°vel)
    </ResponseField>
  </Expandable>
</ResponseField>

## Exemplos de Uso

<RequestExample>

```bash Preview com ID
curl -X POST https://sac-waffle-v2.theo-110.workers.dev/support/fast-response \
  -H "Content-Type: application/json" \
  -d '{
    "id": 12345
  }'
```

```bash Preview Manual
curl -X POST https://sac-waffle-v2.theo-110.workers.dev/support/fast-response \
  -H "Content-Type: application/json" \
  -d '{
    "issue": "Erro ao fazer login",
    "description": "Quando tento fazer login, aparece erro 500 e n√£o consigo acessar minha conta. J√° tentei limpar o cache.",
    "main": "T√©cnico",
    "newsletter": "the news"
  }'
```

```bash Para Ticket Existente
curl -X POST https://sac-waffle-v2.theo-110.workers.dev/support/12345/fast-response \
  -H "Authorization: Bearer seu_token_jwt" \
  -H "Content-Type: application/json" \
  -d '{
    "salvar": true,
    "autor": "Suporte IA",
    "enviar_email": true
  }'
```

```bash Processamento em Lote
curl -X POST https://sac-waffle-v2.theo-110.workers.dev/support/fast-response/lote \
  -H "Authorization: Bearer seu_token_jwt" \
  -H "Content-Type: application/json" \
  -d '{
    "support_ids": [12345, 12346, 12347],
    "salvar": false,
    "autor": "IA Assistant"
  }'
```

</RequestExample>

<ResponseExample>

```json Preview Response
{
  "success": true,
  "data": {
    "response": "Ol√°! Entendo sua frustra√ß√£o com o erro 500 ao fazer login. Este √© um erro do servidor que estamos monitorando. Como voc√™ j√° limpou o cache, sugiro:\n\n1. Tente usar outro navegador ou modo an√¥nimo\n2. Verifique se est√° usando o email correto\n3. Use a op√ß√£o 'Esqueci minha senha' para redefinir\n\nSe o problema persistir ap√≥s estas tentativas, nossa equipe t√©cnica est√° investigando e resolver√° em breve. Por favor, nos informe qual navegador est√° usando para ajudar na investiga√ß√£o.",
    "confidence": 0.85,
    "basedOnSimilar": true,
    "similarTicketsUsed": 3
  }
}
```

```json Ticket com Salvamento
{
  "success": true,
  "data": {
    "ticket_id": 12345,
    "resposta": "Agradecemos seu contato. Identificamos o problema com sua assinatura e j√° corrigimos. Voc√™ deve receber as pr√≥ximas edi√ß√µes normalmente. Um cr√©dito foi adicionado √† sua conta pelos dias perdidos.",
    "confianca": 0.92,
    "baseado_em_similares": true,
    "tickets_similares_usados": 5,
    "salvo": true,
    "email_enviado": true
  }
}
```

```json Lote com Preview
{
  "success": true,
  "data": {
    "modo": "lote_preview",
    "tickets_processados": 3,
    "sucesso": 3,
    "falhas": 0,
    "respostas": [
      {
        "ticket_id": 12345,
        "resposta": "Ol√°! Vejo que est√° com problemas no login...",
        "confianca": 0.88,
        "baseado_em_similares": true,
        "tickets_similares_usados": 4
      },
      {
        "ticket_id": 12346,
        "resposta": "Sobre sua cobran√ßa duplicada...",
        "confianca": 0.95,
        "baseado_em_similares": true,
        "tickets_similares_usados": 7
      },
      {
        "ticket_id": 12347,
        "resposta": "Referente ao cancelamento solicitado...",
        "confianca": 0.76,
        "baseado_em_similares": false,
        "tickets_similares_usados": 0
      }
    ]
  }
}
```

```json Lote com Salvamento
{
  "success": true,
  "data": {
    "modo": "lote_com_salvamento",
    "tickets_processados": 5,
    "salvos": 4,
    "falhas": 1,
    "resultados": [
      {
        "ticket_id": 12345,
        "sucesso": true,
        "resposta_salva": true,
        "email_enviado": true,
        "confianca": 0.91
      },
      {
        "ticket_id": 12346,
        "sucesso": true,
        "resposta_salva": true,
        "email_enviado": false,
        "confianca": 0.83
      },
      {
        "ticket_id": 12347,
        "sucesso": false,
        "erro": "Confian√ßa muito baixa para salvar automaticamente"
      }
    ]
  }
}
```

</ResponseExample>

## Caracter√≠sticas do Sistema

### üß† Intelig√™ncia Contextual

- **An√°lise de Similaridade**: Busca tickets anteriores similares para melhorar a precis√£o
- **Aprendizado Cont√≠nuo**: Usa hist√≥rico de respostas bem-sucedidas
- **Categoriza√ß√£o Inteligente**: Considera categoria e newsletter para respostas espec√≠ficas

### ‚ö° Performance

- **Cache de Respostas**: Respostas similares s√£o cacheadas por 5 minutos
- **Processamento Paralelo**: Lotes s√£o processados simultaneamente
- **Timeout Configur√°vel**: 30 segundos por requisi√ß√£o

### üõ°Ô∏è Seguran√ßa e Qualidade

- **Threshold de Confian√ßa**: Respostas com confian√ßa < 0.3 n√£o s√£o salvas automaticamente
- **Valida√ß√£o de Conte√∫do**: Filtros para evitar respostas inadequadas
- **Limite de Tokens**: M√°ximo de 500 tokens por resposta
- **Rate Limiting**: 100 requisi√ß√µes por minuto

### üìä M√©tricas e Monitoramento

- **Tracking de Confian√ßa**: Todas as respostas incluem n√≠vel de confian√ßa
- **Auditoria**: Log completo de respostas geradas e utilizadas
- **Feedback Loop**: Sistema aprende com respostas marcadas como √∫teis

## Boas Pr√°ticas

### Para Desenvolvedores

1. **Use Preview Primeiro**: Sempre teste com preview antes de salvar
2. **Valide Confian√ßa**: Considere revis√£o manual para confian√ßa < 0.7
3. **Batch com Modera√ß√£o**: Use lotes menores (10-20) para melhor controle
4. **Monitor de Custos**: Cada requisi√ß√£o consome tokens da OpenAI

### Para Produtos

1. **UX de Loading**: Mostre indicador de processamento (pode levar 5-10s)
2. **Preview Obrigat√≥rio**: Sempre mostre preview antes de enviar ao cliente
3. **Fallback Manual**: Tenha op√ß√£o de editar antes de enviar
4. **M√©tricas de Sucesso**: Acompanhe taxa de aceita√ß√£o das respostas

## Limites e Custos

| Recurso | Limite | Observa√ß√£o |
|---------|--------|------------|
| Tokens por resposta | 500 | ~375 palavras |
| Tickets por lote | 50 | Recomendado: 20 |
| Timeout | 30s | Por requisi√ß√£o |
| Rate limit | 100/min | Por IP |
| Cache | 5 min | Para respostas id√™nticas |

## Troubleshooting

### Erro: "Confian√ßa muito baixa"
- **Causa**: IA n√£o tem certeza da resposta
- **Solu√ß√£o**: Forne√ßa mais contexto ou revise manualmente

### Erro: "Timeout na gera√ß√£o"
- **Causa**: OpenAI demorou muito
- **Solu√ß√£o**: Tente novamente ou reduza o lote

### Erro: "Limite de tokens excedido"
- **Causa**: Descri√ß√£o muito longa
- **Solu√ß√£o**: Resuma a descri√ß√£o do problema